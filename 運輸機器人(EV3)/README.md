# 運輸機器人（EV3 全自動循跡）

> 本目錄包含 EV3 運輸機器人的全部資料。

## 系統架構

```
EV3 Brick (Pybricks MicroPython)
    ├── Port B: 左輪大馬達
    ├── Port C: 右輪大馬達
    ├── Port A: 放置機構中馬達
    ├── Port S1: 左顏色感測器（循跡）
    ├── Port S2: 右顏色感測器（循跡）
    ├── Port S3: 前方顏色感測器（停止線）
    └── Port S4: 觸碰感測器（啟動/零件偵測）
```

## 任務流程

```
等待啟動 → PID 循跡 → 偵測黃色停止線 → 停車放置零件
                                              ↓
              偵測紅色停止線 ← 繼續循跡 ← 繼續前進
                    ↓
              停車等待下一輪
```

## 控制方式

- **全自動**（無遙控）
- 雙感測器 PID 循跡黑線
- 前方感測器偵測黃色（放置區）/ 紅色（起點）停止線

## 目錄結構

```
運輸機器人(EV3)/
├── README.md                    ← 本文件
├── BOM.md                       ← 零件清單
├── ev3_program/
│   └── transport_robot.py       ← EV3 MicroPython 主程式
└── 機構設計/
    └── EV3組裝設計參考.md        ← 組裝要點
```

## 快速開始

1. 閱讀 [BOM.md](BOM.md) 確認零件
2. 依照 [EV3組裝設計參考.md](機構設計/EV3組裝設計參考.md) 組裝
3. 安裝 [VS Code + EV3 MicroPython 擴充](https://pybricks.com/ev3-micropython/)
4. 將 `transport_robot.py` 部署到 EV3
5. 在場地上調校 PID 參數

## PID 參數調校

程式中的關鍵參數（在 `transport_robot.py` 開頭）：

| 參數 | 預設值 | 說明 |
|------|--------|------|
| `KP` | 1.2 | 比例增益（越大轉向越敏感） |
| `KI` | 0.01 | 積分增益（消除穩態誤差） |
| `KD` | 0.5 | 微分增益（抑制震盪） |
| `BASE_SPEED` | 100 mm/s | 基礎行駛速度 |
| `LINE_THRESHOLD` | 20 | 黑線反射值閾值 |

### 調校步驟

1. **先只調 KP**（KI=0, KD=0）→ 讓車子能大致跟著線走
2. **加入 KD** → 減少左右晃動
3. **微調 KI** → 消除持續偏移
4. **調整 BASE_SPEED** → 在穩定性和速度間取得平衡
